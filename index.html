<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
  <title>BLADE: HIGH-VISIBILITY</title>

  <!-- ✅ 외부 CSS (경로 변경: RPG-GAME/css.html/style.css) -->
  <link id="blade-style" rel="stylesheet" href="./RPG-GAME/css.html/style.css" />

  <!-- ✅ CSS가 안 먹어도 “오버레이 글자 도배” 방지 + 에러 표시용 최소 스타일 -->
  <style>
    html,body{height:100%;margin:0;background:#000;overflow:hidden;font-family:Arial, sans-serif;}
    canvas{display:block;}
    .overlay{display:none;}
    #boot{
      position:fixed;inset:0;display:flex;align-items:center;justify-content:center;
      background:rgba(0,0,0,.92);color:#fff;z-index:9998;text-align:center;padding:20px;
      font:700 18px/1.5 Arial, sans-serif;
    }
    #debug{
      position:fixed;left:10px;bottom:10px;z-index:9999;display:none;
      max-width:min(92vw,860px);white-space:pre-wrap;font:12px/1.4 ui-monospace,Consolas,monospace;
      background:rgba(0,0,0,.78);color:#fff;border:1px solid rgba(255,255,255,.28);
      padding:10px;border-radius:12px
    }
  </style>
</head>

<body>
  <!-- ✅ 부팅/에러 안내(정상 실행되면 game.js가 자동으로 숨김) -->
  <div id="boot">
    LOADING...<br/>
    만약 이 화면이 계속 유지되면<br/>
    <b>./RPG-GAME/js.html/game.js</b> 또는 <b>./RPG-GAME/css.html/style.css</b> 경로가 틀린 겁니다.
  </div>

  <!-- HUD -->
  <div id="ui">
    <div id="stats">LV.1 에테르 기사</div>
    <div class="bar-container"><div id="hp-fill"></div></div>

    <div id="meta">
      <span class="pill">WAVE <b id="wave">1</b></span>
      <span class="pill">GOLD <b id="gold">0</b></span>
      <span class="pill" id="challenge-pill" style="display:none;">MODE <b id="challenge-label">NORMAL</b></span>
      <span class="pill" id="nohit-pill" style="display:none;">NO-HIT <b id="nohit-label">OK</b></span>
      <span class="pill" id="time-pill" style="display:none;">TIME <b id="time-label">0.0</b>s</span>
    </div>

    <div id="awk-timer" style="display:none;">OVERDRIVE: 10s</div>
    <div id="cooldowns">
      DASH <b id="cd-dash">0.0</b>s ·
      Q <b id="cd-q">0.0</b>s ·
      E <b id="cd-e">0.0</b>s ·
      R <b id="cd-r">0.0</b>s
    </div>

    <div id="score">SCORE: 0</div>
    <div class="bar-container exp" style="height:8px;"><div id="exp-fill"></div></div>
  </div>

  <div id="item-msg"></div>
  <div id="hit-flash" aria-hidden="true"></div>

  <button id="pause-btn" aria-label="pause">⏸</button>

  <!-- Touch controls -->
  <div id="touch" aria-hidden="true">
    <div class="touch-col">
      <div class="tbtn" id="t-left">◀</div>
      <div class="tbtn" id="t-right">▶</div>
    </div>
    <div class="touch-col">
      <div class="tbtn big" id="t-jump">⤒</div>
      <div class="tbtn" id="t-dash">⇢</div>
    </div>
    <div class="touch-col">
      <div class="tbtn" id="t-q">Q</div>
      <div class="tbtn" id="t-e">E</div>
      <div class="tbtn" id="t-r">R</div>
    </div>
  </div>

  <canvas id="gameCanvas"></canvas>

  <!-- 오버레이들(본 게임 버전에서 사용) -->
  <div id="title-menu" class="overlay" style="display:none;"></div>
  <div id="pause-menu" class="overlay" style="display:none;"></div>
  <div id="reward-menu" class="overlay" style="display:none;"></div>
  <div id="shop-menu" class="overlay" style="display:none;"></div>
  <div id="options-menu" class="overlay" style="display:none;"></div>
  <div id="overlay" class="overlay" style="display:none;"></div>

  <div id="debug"></div>

  <script>
    (function(){
      const debug = (msg) => {
        const el = document.getElementById("debug");
        if(!el) return;
        el.style.display = "block";
        el.textContent = msg;
      };

      // ✅ CSS 로딩 체크
      setTimeout(() => {
        try{
          const target = "/RPG-GAME/css.html/style.css";
          const ok = Array.from(document.styleSheets).some(ss => (ss.href||"").includes(target) || (ss.href||"").endsWith("RPG-GAME/css.html/style.css"));
          if(!ok){
            debug("style.css가 적용되지 않았습니다.\n경로: ./RPG-GAME/css.html/style.css\n※ css.html은 ‘폴더’여야 합니다(파일 아님).");
          }
        }catch(e){}
      }, 700);

      // ✅ game.js 로더 (경로 변경: RPG-GAME/js.html/game.js)
      const s = document.createElement("script");
      s.src = "./RPG-GAME/js.html/game.js?v=3";
      s.onload = () => {
        setTimeout(() => {
          if(!window.__BLADE_BOOTED){
            debug("game.js가 로드되었지만 초기화 신호가 없습니다.\n콘솔(F12) 에러를 확인하세요.");
          }
        }, 800);
      };
      s.onerror = () => {
        debug("game.js 로드 실패!\n경로: ./RPG-GAME/js.html/game.js\n폴더/파일 이름을 확인하세요\ngame.js가 실행되지 않았습니다.\n※ js.html은 ‘폴더’여야 합니다(파일 아님).");
      };
      document.body.appendChild(s);
    })();
  </script>
</body>
</html>
